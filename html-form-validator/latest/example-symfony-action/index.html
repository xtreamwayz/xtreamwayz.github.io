<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>Example Symfony action &ndash; xtreamwayz</title>
<link rel=stylesheet href=https://xtreamwayz.github.io/style/main.min.73e2bb085dd1b932972ab59f1b394c67e753d29956f59eac51d21b1aeeb29c01ef5cb8ed0ad97fb91e7f2d98b3b51134e356d2889d596e9341d2a355a4bdcb6a.css integrity="sha512-c+K7CF3RuTKXKrWfGzlMZ+dT0plW9Z6sUdIbGu6ynAHvXLjtCtl/uR5/LZiztRE041bSiJ1ZbpNB0qNVpL3Lag==" media=screen>
</head>
<body class=app>
<header class="app-header navbar navbar-expand navbar-dark bg-dark text-white">
<nav class="nav-container container">
<a class="navbar-brand text-primary text-uppercase font-weight-bold" href=https://xtreamwayz.github.io/ aria-label="It starts with an idea">
xtreamwayz
</a>
<ul class="navbar-nav mr-auto">
<li class="nav-item dropdown">
<a class="nav-item nav-link dropdown-toggle mr-md-2" href=# id=bd-projects data-toggle=dropdown aria-haspopup=true aria-expanded=false>
html-form-validator
</a>
<div class="dropdown-menu dropdown-menu-right" aria-labelledby=bd-projects>
<a class=dropdown-item href=https://xtreamwayz.github.io/psr-container-messenger/>
psr-container-messenger
</a>
<a class=dropdown-item href=https://xtreamwayz.github.io/html-form-validator/>
html-form-validator
</a>
<a class=dropdown-item href=https://xtreamwayz.github.io/mezzio-console/>
mezzio-console
</a>
</div>
</li><div class=dropdown>
<a class="nav-item nav-link mr-md-2 dropdown-toggle" href=# role=button id=header-html-form-validator-v1 data-toggle=dropdown aria-haspopup=true aria-expanded=false>
Version v1
</a>
<div class=dropdown-menu aria-labelledby=header-html-form-validator-v1>
<a class=dropdown-item href=https://xtreamwayz.github.io/html-form-validator/latest/>
Latest (v1)
</a>
</div>
</div></ul>
</nav>
</header>
<main class=app-content>
<article class=container>
<header>
<h1>Example Symfony action</h1>
</header>
<div class=d-flex>
<div class=flex-grow-1>
<nav id=TableOfContents></nav>
</div>
<nav class="nav flex-column nav-pills mb-4">
<a class="nav-link btn btn-sm btn-primary m-1" href=https://github.com/xtreamwayz/html-form-validator>
Source
</a>
<a class="nav-link btn btn-sm btn-primary m-1" href="https://github.com/xtreamwayz/html-form-validator/issues/new?template=bug-report.md&title=docs:%20issue%20with%20html-form-validator%2flatest%2fexample-symfony-action.md">
Report issue
</a>
</nav>
</div>
<p>Symfony forms can be a real pain to design and even worse to debug. Luckily you are not bound to use Symfony forms and
can use something else if you like to. For example this html-form-factory :)</p>
<p>Let&rsquo;s take the contact form as an example and use it in a Symfony application. For the fun of it the ADR
(Action-Domain-Response) pattern is being to used which can easily be achieved by registering the action as a service.
Or use the <a href=https://github.com/dunglas/DunglasActionBundle/>DunglasActionBundle</a> to do this for you.</p>
<p>The form is pretty basic and has extra StringTrim and StripTags filters for the name and subject input fields. It
also has csrf protection with a hidden token which is validated with the identical validator.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=c>&lt;!-- // app/Resources/views/contact-form.html.twig --&gt;</span>
<span class=p>&lt;</span><span class=nt>form</span> <span class=na>action</span><span class=o>=</span><span class=s>&#34;{{ app.request.schemeAndHttpHost ~ app.request.requestUri }}&#34;</span> <span class=na>method</span><span class=o>=</span><span class=s>&#34;post&#34;</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-group&#34;</span><span class=p>&gt;</span>
        <span class=p>&lt;</span><span class=nt>label</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-control-label&#34;</span> <span class=na>for</span><span class=o>=</span><span class=s>&#34;name&#34;</span><span class=p>&gt;</span>Name<span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
        <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text&#34;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;name&#34;</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;name&#34;</span> <span class=na>placeholder</span><span class=o>=</span><span class=s>&#34;Your name&#34;</span> <span class=na>required</span>
               <span class=na>data-reuse-submitted-value</span><span class=o>=</span><span class=s>&#34;true&#34;</span> <span class=na>data-filters</span><span class=o>=</span><span class=s>&#34;stringtrim|striptags&#34;</span>
               <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-control&#34;</span> <span class=p>/&gt;</span>
    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>

    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-group&#34;</span><span class=p>&gt;</span>
        <span class=p>&lt;</span><span class=nt>label</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-control-label&#34;</span> <span class=na>for</span><span class=o>=</span><span class=s>&#34;email&#34;</span><span class=p>&gt;</span>Email address<span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
        <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;email&#34;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;email&#34;</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;email&#34;</span> <span class=na>placeholder</span><span class=o>=</span><span class=s>&#34;Your email address&#34;</span>
               <span class=na>data-reuse-submitted-value</span><span class=o>=</span><span class=s>&#34;true&#34;</span> <span class=na>required</span>
               <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-control&#34;</span> <span class=p>/&gt;</span>
    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>

    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-group&#34;</span><span class=p>&gt;</span>
        <span class=p>&lt;</span><span class=nt>label</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-control-label&#34;</span> <span class=na>for</span><span class=o>=</span><span class=s>&#34;subject&#34;</span><span class=p>&gt;</span>Subject<span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
        <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text&#34;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;subject&#34;</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;subject&#34;</span> <span class=na>placeholder</span><span class=o>=</span><span class=s>&#34;Subject&#34;</span> <span class=na>required</span>
               <span class=na>data-reuse-submitted-value</span><span class=o>=</span><span class=s>&#34;true&#34;</span> <span class=na>data-filters</span><span class=o>=</span><span class=s>&#34;stringtrim|striptags&#34;</span>
               <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-control&#34;</span> <span class=p>/&gt;</span>
    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>

    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-group&#34;</span><span class=p>&gt;</span>
        <span class=p>&lt;</span><span class=nt>label</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-control-label&#34;</span> <span class=na>for</span><span class=o>=</span><span class=s>&#34;body&#34;</span><span class=p>&gt;</span>Message<span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
        <span class=p>&lt;</span><span class=nt>textarea</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;body&#34;</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;body&#34;</span> <span class=na>rows</span><span class=o>=</span><span class=s>&#34;5&#34;</span> <span class=na>required</span>
                  <span class=na>data-reuse-submitted-value</span><span class=o>=</span><span class=s>&#34;true&#34;</span>
                  <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-control&#34;</span> <span class=na>placeholder</span><span class=o>=</span><span class=s>&#34;Message&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>textarea</span><span class=p>&gt;</span>
    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>

    <span class=c>&lt;!-- csrf protection --&gt;</span>
    <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;hidden&#34;</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;token&#34;</span> <span class=na>value</span><span class=o>=</span><span class=s>&#34;{{ token }}&#34;</span> <span class=na>data-validators</span><span class=o>=</span><span class=s>&#34;identical{token:{{ token }}&#34;</span> <span class=na>required</span> <span class=p>/&gt;</span>

    <span class=p>&lt;</span><span class=nt>button</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;submit&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;btn btn-primary&#34;</span><span class=p>&gt;</span>Submit<span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>form</span><span class=p>&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>This is an example of how an Action may look like. We&rsquo;ll walk through each step in the comments.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=o>&lt;?</span><span class=nx>php</span> <span class=c1>// src/AppBundle/Action/ContactAction.php
</span><span class=c1></span>
<span class=k>namespace</span> <span class=nx>AppBundle\Action</span><span class=p>;</span>

<span class=k>use</span> <span class=nx>Sensio\Bundle\FrameworkExtraBundle\Configuration\Method</span><span class=p>;</span>
<span class=k>use</span> <span class=nx>Sensio\Bundle\FrameworkExtraBundle\Configuration\Route</span><span class=p>;</span>
<span class=k>use</span> <span class=nx>Symfony\Component\HttpFoundation\RedirectResponse</span><span class=p>;</span>
<span class=k>use</span> <span class=nx>Symfony\Component\HttpFoundation\Request</span><span class=p>;</span>
<span class=k>use</span> <span class=nx>Symfony\Component\HttpFoundation\Response</span><span class=p>;</span>
<span class=k>use</span> <span class=nx>Symfony\Component\Routing\RouterInterface</span><span class=p>;</span>
<span class=k>use</span> <span class=nx>Symfony\Component\Templating\EngineInterface</span><span class=p>;</span>
<span class=k>use</span> <span class=nx>Xtreamwayz\HTMLFormValidator\FormFactory</span><span class=p>;</span>

<span class=k>class</span> <span class=nc>ContactAction</span>
<span class=p>{</span>
    <span class=k>private</span> <span class=nv>$router</span><span class=p>;</span>
    <span class=k>private</span> <span class=nv>$template</span><span class=p>;</span>

    <span class=k>public</span> <span class=k>function</span> <span class=fm>__construct</span><span class=p>(</span>
        <span class=nx>RouterInterface</span> <span class=nv>$router</span><span class=p>,</span>
        <span class=nx>EngineInterface</span> <span class=nv>$template</span><span class=p>,</span>
    <span class=p>)</span> <span class=p>{</span>
        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>router</span>   <span class=o>=</span> <span class=nv>$router</span><span class=p>;</span>
        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>template</span> <span class=o>=</span> <span class=nv>$template</span><span class=p>;</span>
    <span class=p>}</span>

    <span class=sd>/**
</span><span class=sd>     * @Route(&#34;/contact&#34;, name=&#34;contact&#34;)
</span><span class=sd>     * @Method({&#34;GET&#34;, &#34;POST&#34;})
</span><span class=sd>     */</span>
    <span class=k>public</span> <span class=k>function</span> <span class=fm>__invoke</span><span class=p>(</span><span class=nx>Request</span> <span class=nv>$request</span><span class=p>)</span>
    <span class=p>{</span>
        <span class=c1>// Generate csrf token if needed
</span><span class=c1></span>        <span class=nv>$session</span> <span class=o>=</span> <span class=nv>$request</span><span class=o>-&gt;</span><span class=na>getSession</span><span class=p>();</span>
        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nv>$session</span><span class=o>-&gt;</span><span class=na>get</span><span class=p>(</span><span class=s1>&#39;csrf&#39;</span><span class=p>))</span> <span class=p>{</span>
            <span class=nv>$session</span><span class=o>-&gt;</span><span class=na>set</span><span class=p>(</span><span class=s1>&#39;csrf&#39;</span><span class=p>,</span> <span class=nx>md5</span><span class=p>(</span><span class=nx>random_bytes</span><span class=p>(</span><span class=mi>32</span><span class=p>)));</span>
        <span class=p>}</span>

        <span class=c1>// Generate the form from the template with the template renderer and inject the csrf token
</span><span class=c1></span>        <span class=nv>$form</span> <span class=o>=</span> <span class=p>(</span><span class=k>new</span> <span class=nx>FormFactory</span><span class=p>())</span><span class=o>-&gt;</span><span class=na>fromHtml</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>template</span><span class=o>-&gt;</span><span class=na>render</span><span class=p>(</span><span class=s1>&#39;contact-form.html.twig&#39;</span><span class=p>,</span> <span class=p>[</span>
            <span class=s1>&#39;token&#39;</span> <span class=o>=&gt;</span> <span class=nv>$session</span><span class=o>-&gt;</span><span class=na>get</span><span class=p>(</span><span class=s1>&#39;csrf&#39;</span><span class=p>),</span>
        <span class=p>]));</span>

        <span class=c1>// Validate request and get a validation result. The request method is passed to check if the form is
</span><span class=c1></span>        <span class=c1>// being posted.
</span><span class=c1></span>        <span class=nv>$validationResult</span> <span class=o>=</span> <span class=nv>$form</span><span class=o>-&gt;</span><span class=na>validate</span><span class=p>(</span><span class=nv>$request</span><span class=o>-&gt;</span><span class=na>request</span><span class=o>-&gt;</span><span class=na>all</span><span class=p>(),</span> <span class=nv>$request</span><span class=o>-&gt;</span><span class=na>getMethod</span><span class=p>());</span>

        <span class=c1>// It should be valid if it was a post and if there are no validation messages
</span><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=nv>$validationResult</span><span class=o>-&gt;</span><span class=na>isValid</span><span class=p>())</span> <span class=p>{</span>
            <span class=c1>// Get filtered submitted values
</span><span class=c1></span>            <span class=nv>$data</span> <span class=o>=</span> <span class=nv>$validationResult</span><span class=o>-&gt;</span><span class=na>getValues</span><span class=p>();</span>

            <span class=c1>// Process data
</span><span class=c1></span>
            <span class=k>return</span> <span class=k>new</span> <span class=nx>RedirectResponse</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>router</span><span class=o>-&gt;</span><span class=na>generate</span><span class=p>(</span><span class=s1>&#39;homepage&#39;</span><span class=p>));</span>
        <span class=p>}</span>

        <span class=c1>// Display the form and inject the validation messages if there are any
</span><span class=c1></span>        <span class=k>return</span> <span class=k>new</span> <span class=nx>HtmlResponse</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>template</span><span class=o>-&gt;</span><span class=na>render</span><span class=p>(</span><span class=s1>&#39;app::edit&#39;</span><span class=p>,</span> <span class=p>[</span>
            <span class=s1>&#39;form&#39;</span> <span class=o>=&gt;</span> <span class=nv>$form</span><span class=o>-&gt;</span><span class=na>asString</span><span class=p>(</span><span class=nv>$validationResult</span><span class=p>),</span>
        <span class=p>]));</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div>
<footer class="my-5 text-muted">
This page, including the code samples, is licensed under the <a href=https://creativecommons.org/licenses/by/4.0/>Creative Commons CC BY 4.0</a> license.
</footer>
</article>
</main>
<footer class="app-footer p-3">
<div class=container>
<p class=text-center>
&copy; 2016-2022 <a href=https://geerteltink.github.io/> Geert Eltink</a>
</p>
</div>
</footer>
<script src=https://code.jquery.com/jquery-3.5.1.slim.min.js integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" crossorigin=anonymous></script>
<script src=https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js integrity=sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV crossorigin=anonymous></script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-151173516-1','auto'),ga('send','pageview'))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
</body>
</html>